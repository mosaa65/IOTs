# إنترنت الأشياء (IoT) — المحاضرة 3: IoT Architecture

**المحاضر:** Shamsan Qaashah  
**المقرر:** Internet of Things (IOTs)

## ملخص سريع
- مكوّنات منظومة IoT ووظائفها الأساسية.
- البنية المعمارية ومكوّناتها الأربعة الرئيسة.
- التصميم المنطقي وكتل الوظائف (Functional Blocks).
- نماذج الاتصال وواجهات الاتصال (REST/WebSocket).
- طبقات البروتوكولات ومسؤولياتها.

## 1) فكرة عامة عن نظام IoT
- نظام IoT مزيج من كتل وظيفية تهدف لتسهيل الاتصال والأتمتة.
- الوظائف الأساسية تشمل: الاستشعار، الإدارة، التعريف، التشغيل/التحكم.
- جهاز IoT يتكوّن من واجهات متعددة: حساسات، صوت/فيديو، اتصال بالإنترنت، ذاكرة/تخزين.
- البيانات تُجمع وتُحلّل لإنتاج معلومات ذات قيمة.

## 2) مكونات بنية IoT الرئيسية
**أربع طبقات/مكوّنات أساسية:**
1. **Sensors/Devices (أجهزة الاستشعار/الأجهزة).**
2. **Gateways and Networks (البوابات والشبكات).**
3. **Cloud/Management Service Layer (السحابة/خدمات الإدارة).**
4. **Application Layer (طبقة التطبيقات).**

### 2.1 أجهزة الاستشعار (Sensors/Devices)
- قادرة على بث البيانات ومعالجتها عبر الشبكة (سلكي/لاسلكي).
- أمثلة حساسات: GPS، جيروسكوب، حساسات كهروميكانيكية/كيميائية، RFID.
- غالبا تحتاج لبوابات للاتصال.
- يمكن ربطها عبر LAN أو PAN.

### 2.2 البوابات والشبكات (Gateways and Networks)
- ضرورية بسبب الكم الكبير من البيانات الناتجة عن الحساسات.
- قد تكون الشبكة LAN (مثل Ethernet وWi‑Fi) أو WAN (مثل GSM و5G).

## 3) الطبقات العالمية لإنترنت الأشياء (حسب المخطط في الشرائح)
المخطط يعرض سلّماً من أربع طبقات مع أسهم ثنائية الاتجاه (بيانات صاعدة + أوامر هابطة). توضيح موسّع لكل طبقة:
- **طبقة الإدراك / الاستشعار (Perception):** أجهزة الاستشعار، RFID، أجهزة تحديد الموقع، كاميرات؛ تحوّل الظواهر الفيزيائية إلى بيانات رقمية؛ تشمل مبدلات A/D وأحياناً معالجة أولية (فلترة/ضغط).
- **طبقة النقل / الشبكة (Network):** مسؤولة عن ربط الأشياء بالبوابات أو المنصة. تقنيات رئيسية:  
  - قريب المدى ومنخفض الطاقة: ZigBee/802.15.4، BLE، NFC، RFID.  
  - متوسط المدى: Wi‑Fi، Thread، 6LoWPAN فوق 802.15.4.  
  - بعيد المدى ومنخفض الطاقة: LoRa/LoRaWAN، Sigfox، NB‑IoT، LTE‑M.  
  - خلوي عام: 2G/3G/4G/5G.  
  تنفّذ التوجيه، التجميع، وضبط الجودة (QoS) بحسب الحاجة.
- **طبقة المنصة / الخدمات (Platform & Services):** طبقة تشغيلية على خوادم محلية أو سحابة؛ تقوم بـ: إدارة الهوية والأجهزة (Provisioning)، التخزين، التحليلات الدُفُعية والفورية (Stream Processing)، الأمان (مصادقة/تشفير/سياسات وصول)، التكامل APIs، إدارة التكوينات والتحديثات OTA.
- **طبقة التطبيق (Application):** لوحات المراقبة، تنبيهات، أتمتة منطق الأعمال، تكامل مع نظم ERP/CRM/SCADA؛ هي المكان الذي تُستهلك فيه البيانات وتُحوّل إلى قرارات أو قيمة اقتصادية.
**تدفق البيانات (وفق الرسم):** قياس من الحساس → تجميع/نقل عبر شبكة قريبة → بوابة/سحابة تستقبل وتخزّن وتحلل → نتيجة/أمر يُرجع للأجهزة أو يظهر للمستخدم (تحكم راجع).

## 4) التصميم المنطقي لـ IoT (Logical Design)
الشرائح تحوّل السلّم السابق إلى نموذج كيانات وتجريد عمليات بدون تفاصيل تنفيذية:
- **كيانات أساسية:** أجهزة/أشياء، بوابات/شبكات، منصات إدارة، تطبيقات.
- **عمليات أساسية:** الاستشعار، التعريف/الهوية، الاتصال، الأمن، الإدارة، التشغيل/التفعيل.
- **الفكرة:** كل جهاز لديه هوية فريدة، يجمع بيانات، يرسلها عبر شبكة معيارية، تُعالَج وتُخزن، ثم تُستهلك عبر تطبيقات.

## 5) الكتل الوظيفية في IoT (Functional Blocks)
يمثل الرسم ست كتل مترابطة:
1) **Device:** استشعار، مراقبة، تشغيل محلي.  
2) **Communication:** ربط الأجهزة بالبوابات/الخوادم عبر طبقات النقل والشبكة.  
3) **Security:** مصادقة، تفويض، سلامة البيانات.  
4) **Management:** كشف الأجهزة، تهيئة، مراقبة الحالة، تحديثات.  
5) **Services:** تجميع البيانات، النمذجة، التحكم، واجهات برمجية وسيطة.  
6) **Application:** واجهة المستخدم ولوحات التحكم.

## 6) نماذج الاتصال في IoT (Communication Models)
الشرائح تعرض أربعة نماذج بصرياً:
- **Request‑Response:** العميل يرسل طلباً (GET/POST)، الخادم يجيب؛ مناسب للاستعلامات المباشرة.
- **Publish‑Subscribe:** ناشر → وسيط (Broker) → مستهلكين مشتركين في موضوع؛ يفصل المنتجين عن المستهلكين.
- **Push‑Pull:** المنتج يدفع البيانات إلى طابور انتظار؛ المستهلك يسحب عند حاجته، يفيد عند تفاوت السرعات.
- **Exclusive Pair:** قناة ثنائية مستمرة (socket/WebSocket) بين طرفين لتبادل فوري منخفض الكمون.

## 7) واجهات الاتصال (Communication APIs)
- **REST (HTTP/HTTPS):** موارد، عمليات CRUD، يتبع نموذج Request‑Response.
- **WebSocket:** قناة ثنائية دائمة، يدعم نموذج Exclusive Pair للتحديث الفوري.

## 8) طبقات البروتوكولات ومسؤولياتها (تفصيل من جداول الصفحات 26–31)

| الطبقة | الدور الرئيس | بروتوكولات/تقنيات IoT شائعة | ملاحظات اختيار |
| --- | --- | --- | --- |
| Physical / Link | الوسط المادي، التعديل، الوصول للوسيط، MAC | 802.15.4 (ZigBee/6LoWPAN)، BLE، Wi‑Fi، PLC، UWB | يختار وفق المدى/الطاقة/المعدل؛ 802.15.4 للبطاريات، Wi‑Fi للسرعة |
| Network / Internet | العنونة والتوجيه بين الشبكات | IPv6 أساساً، 6LoWPAN لضغط رؤوس IPv6، أحياناً IPv4، RPL لتوجيه الشبكات منخفضة الطاقة | IPv6 يوفر فضاء عناوين ضخم؛ RPL يبني شجر موجه في شبكات LLN |
| Transport | نقل طرف‑لطرف، الموثوقية، التحكم بالتدفق | UDP (خفيف)، TCP (موثوق)، DTLS فوق UDP، QUIC أحياناً | UDP يقلل الزمن والطاقة؛ يُستخدم مع DTLS للأمان |
| Session/Presentation | تشفير/ضغط/تنسيق الرسائل | TLS/DTLS، CBOR/JSON، EXI | CBOR أخف من JSON؛ TLS للموثوقية، DTLS عند استخدام UDP |
| Application | نماذج الرسائل وواجهات التطبيقات | CoAP (REST خفيف، Observe، Blockwise)، MQTT (Pub/Sub QoS 0/1/2)، AMQP، XMPP، HTTP/HTTPS، WebSocket | CoAP يناسب UDP والأجهزة الصغيرة؛ MQTT يناسب الاتصال غير الموثوق مع وسيط؛ HTTP/WS للتكامل الويب |

**تفاصيل إضافية من الصور:**  
- CoAP يدعم Confirmable/Non‑Confirmable مع إعادة إرسال بسيطة، وObserve للإشعارات المستمرة.  
- MQTT يوفر ثلاث درجات QoS (At most once, At least once, Exactly once) واحتفاظ بالرسائل (Retain) وجلسات مستمرة.  
- Blockwise في CoAP لتجزئة الموارد الكبيرة، مقابل تجزئة TCP التلقائية في MQTT/HTTP.  
- RPL (Routing Protocol for LLN) يظهر في الرسم كخيار التوجيه لشبكات الحساسات المعتمدة على 6LoWPAN.

## 9) أسئلة/واجب
- اكتب الفرق بين الأنظمة المدمجة (Embedded Systems) وأجهزة إنترنت الأشياء.

## 10) شرح الرسومات في الشرائح (اعتمادا على العناوين)
- **ص 2–4:** مخططات معمارية توضح مكونات IoT وعلاقاتها.
- **ص 6:** طبقات إنترنت الأشياء العالمية.
- **ص 18–19:** مخطط الكتل الوظيفية (Functional Blocks).
- **ص 20–23:** رسومات لنماذج الاتصال الأربعة.
- **ص 24–25:** مخططات توضيحية لواجهات REST وWebSocket.
- **ص 26–31:** طبقات البروتوكولات (Link/Network/Transport/Application).
